<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>6. Python爬虫进阶六之多进程的用法 | Python爬虫学习系列教程</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../chapter4/section7.html" />
    
    
    <link rel="prev" href="../chapter4/section5.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="4.6"
        data-chapter-title="6. Python爬虫进阶六之多进程的用法"
        data-filepath="chapter4/section6.md"
        data-basepath=".."
        data-revision="Wed Jun 21 2017 19:16:14 GMT+0800 (中国标准时间)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Python爬虫学习系列教程
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="chapter1/index.html">
            
                
                    <a href="../chapter1/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        一、爬虫入门
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="chapter1/section1.html">
            
                
                    <a href="../chapter1/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        1. Python爬虫入门一之综述
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="chapter1/section2.html">
            
                
                    <a href="../chapter1/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        2. Python爬虫入门二之爬虫基础了解
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="chapter1/section3.html">
            
                
                    <a href="../chapter1/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        3. Python爬虫入门三之Urllib库的基本使用
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="chapter1/section4.html">
            
                
                    <a href="../chapter1/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        4. Python爬虫入门四之Urllib库的高级用法
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="chapter1/section5.html">
            
                
                    <a href="../chapter1/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        5. Python爬虫入门五之URLError异常处理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="chapter1/section6.html">
            
                
                    <a href="../chapter1/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.6.</b>
                        
                        6. Python爬虫入门六之Cookie的使用
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="chapter1/section7.html">
            
                
                    <a href="../chapter1/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.7.</b>
                        
                        7. Python爬虫入门七之正则表达式
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="chapter2/index.html">
            
                
                    <a href="../chapter2/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        二、爬虫实战
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="chapter2/section1.html">
            
                
                    <a href="../chapter2/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        1. Python爬虫实战一之爬取糗事百科段子
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="chapter2/section2.html">
            
                
                    <a href="../chapter2/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        2. Python爬虫实战二之爬取百度贴吧帖子
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="chapter2/section3.html">
            
                
                    <a href="../chapter2/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        3. Python爬虫实战三之实现山东大学无线网络掉线自动重连
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="chapter2/section4.html">
            
                
                    <a href="../chapter2/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        4. Python爬虫实战四之抓取淘宝MM照片
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="chapter2/section5.html">
            
                
                    <a href="../chapter2/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        5. Python爬虫实战五之模拟登录淘宝并获取所有订单
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="chapter2/section6.html">
            
                
                    <a href="../chapter2/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        6. Python爬虫实战六之抓取爱问知识人问题并保存至数据库
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="chapter2/section7.html">
            
                
                    <a href="../chapter2/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        7. Python爬虫实战七之计算大学本学期绩点
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="chapter2/section8.html">
            
                
                    <a href="../chapter2/section8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        8. Python爬虫实战八之利用Selenium抓取淘宝匿名旺旺
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="chapter3/index.html">
            
                
                    <a href="../chapter3/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        三、爬虫利器
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="chapter3/section1.html">
            
                
                    <a href="../chapter3/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        1. Python爬虫利器一之Requests库的用法
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="chapter3/section2.html">
            
                
                    <a href="../chapter3/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        2. Python爬虫利器二之Beautiful Soup的用法
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="chapter3/section3.html">
            
                
                    <a href="../chapter3/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        3. Python爬虫利器三之Xpath语法与lxml库的用法
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="chapter3/section4.html">
            
                
                    <a href="../chapter3/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        4. Python爬虫利器四之PhantomJS的用法
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="chapter3/section5.html">
            
                
                    <a href="../chapter3/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        5. Python爬虫利器五之Selenium的用法
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="chapter3/section6.html">
            
                
                    <a href="../chapter3/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        6. Python爬虫利器六之PyQuery的用法
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="chapter4/index.html">
            
                
                    <a href="../chapter4/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        四、爬虫进阶
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="chapter4/section1.html">
            
                
                    <a href="../chapter4/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        1. Python爬虫进阶一之爬虫框架概述
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="chapter4/section2.html">
            
                
                    <a href="../chapter4/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        2. Python爬虫进阶二之PySpider框架安装配置
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="chapter4/section3.html">
            
                
                    <a href="../chapter4/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        3. Python爬虫进阶三之爬虫框架Scrapy安装配置
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="chapter4/section4.html">
            
                
                    <a href="../chapter4/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        4. Python爬虫进阶四之PySpider的用法
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="chapter4/section5.html">
            
                
                    <a href="../chapter4/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        5. Python爬虫进阶五之多线程的用法
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="4.6" data-path="chapter4/section6.html">
            
                
                    <a href="../chapter4/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        6. Python爬虫进阶六之多进程的用法
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="chapter4/section7.html">
            
                
                    <a href="../chapter4/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        7. Python爬虫进阶七之设置ADSL拨号服务器代理
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Python爬虫学习系列教程</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="python&#x722C;&#x866B;&#x8FDB;&#x9636;&#x516D;&#x4E4B;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x7528;&#x6CD5;">Python&#x722C;&#x866B;&#x8FDB;&#x9636;&#x516D;&#x4E4B;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x7528;&#x6CD5;</h1>
<h2 id="&#x524D;&#x8A00;">&#x524D;&#x8A00;</h2>
<p>&#x5728;&#x4E0A;&#x4E00;&#x8282;&#x4E2D;&#x4ECB;&#x7ECD;&#x4E86;thread&#x591A;&#x7EBF;&#x7A0B;&#x5E93;&#x3002;python&#x4E2D;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x5176;&#x5B9E;&#x5E76;&#x4E0D;&#x662F;&#x771F;&#x6B63;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x4E0D;&#x80FD;&#x505A;&#x5230;&#x5145;&#x5206;&#x5229;&#x7528;&#x591A;&#x6838;CPU&#x8D44;&#x6E90;&#x3002;</p>
<p>&#x5982;&#x679C;&#x60F3;&#x8981;&#x5145;&#x5206;&#x5229;&#x7528;&#xFF0C;&#x5728;python&#x4E2D;&#x5927;&#x90E8;&#x5206;&#x60C5;&#x51B5;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x591A;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x5305;&#x5C31;&#x53EB;&#x505A; multiprocessing&#x3002;</p>
<p>&#x501F;&#x52A9;&#x5B83;&#xFF0C;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x5B8C;&#x6210;&#x4ECE;&#x5355;&#x8FDB;&#x7A0B;&#x5230;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x7684;&#x8F6C;&#x6362;&#x3002;multiprocessing&#x652F;&#x6301;&#x5B50;&#x8FDB;&#x7A0B;&#x3001;&#x901A;&#x4FE1;&#x548C;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x3001;&#x6267;&#x884C;&#x4E0D;&#x540C;&#x5F62;&#x5F0F;&#x7684;&#x540C;&#x6B65;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;Process&#x3001;Queue&#x3001;Pipe&#x3001;Lock&#x7B49;&#x7EC4;&#x4EF6;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x672C;&#x8282;&#x8981;&#x4ECB;&#x7ECD;&#x7684;&#x5185;&#x5BB9;&#x6709;&#xFF1A;</p>
<ul>
<li>Process</li>
<li>Lock</li>
<li>Semaphore</li>
<li>Queue</li>
<li>Pipe</li>
<li>Pool</li>
</ul>
<h2 id="process">Process</h2>
<h3 id="&#x57FA;&#x672C;&#x4F7F;&#x7528;">&#x57FA;&#x672C;&#x4F7F;&#x7528;</h3>
<p>&#x5728;multiprocessing&#x4E2D;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x7528;&#x4E00;&#x4E2A;Process&#x7C7B;&#x6765;&#x8868;&#x793A;&#x3002;&#x9996;&#x5148;&#x770B;&#x4E0B;&#x5B83;&#x7684;API</p>
<pre><code>Process([group [, target [, name [, args [, kwargs]]]]])
</code></pre><ul>
<li>target&#x8868;&#x793A;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F20;&#x5165;&#x65B9;&#x6CD5;&#x7684;&#x540D;&#x5B57;</li>
<li>args&#x8868;&#x793A;&#x88AB;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x7684;&#x4F4D;&#x7F6E;&#x53C2;&#x6570;&#x5143;&#x7EC4;&#xFF0C;&#x6BD4;&#x5982;target&#x662F;&#x51FD;&#x6570;a&#xFF0C;&#x4ED6;&#x6709;&#x4E24;&#x4E2A;&#x53C2;&#x6570;m&#xFF0C;n&#xFF0C;&#x90A3;&#x4E48;args&#x5C31;&#x4F20;&#x5165;(m, n)&#x5373;&#x53EF;</li>
<li>kwargs&#x8868;&#x793A;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x7684;&#x5B57;&#x5178;</li>
<li>name&#x662F;&#x522B;&#x540D;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x7ED9;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x53D6;&#x4E00;&#x4E2A;&#x540D;&#x5B57;</li>
<li>group&#x5206;&#x7EC4;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x4F7F;&#x7528;</li>
</ul>
<p>&#x6211;&#x4EEC;&#x5148;&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x611F;&#x53D7;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code>import multiprocessing

def process(num):
    print &apos;Process:&apos;, num

if __name__ == &apos;__main__&apos;:
    for i in range(5):
        p = multiprocessing.Process(target=process, args=(i,))
        p.start()
</code></pre><p>&#x6700;&#x7B80;&#x5355;&#x7684;&#x521B;&#x5EFA;Process&#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x4E0A;&#x6240;&#x793A;&#xFF0C;target&#x4F20;&#x5165;&#x51FD;&#x6570;&#x540D;&#xFF0C;args&#x662F;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x662F;&#x5143;&#x7EC4;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5982;&#x679C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x957F;&#x5EA6;&#x4E3A;1&#x7684;&#x5143;&#x7EC4;&#x3002;</p>
<p>&#x7136;&#x540E;&#x8C03;&#x7528;start()&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x542F;&#x52A8;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E86;&#x3002;</p>
<p>&#x53E6;&#x5916;&#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; cpu_count() &#x65B9;&#x6CD5;&#x8FD8;&#x6709; active_children() &#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x673A;&#x5668;&#x7684; CPU &#x6838;&#x5FC3;&#x6570;&#x91CF;&#x4EE5;&#x53CA;&#x5F97;&#x5230;&#x76EE;&#x524D;&#x6240;&#x6709;&#x7684;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x611F;&#x53D7;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code>import multiprocessing
import time

def process(num):
    time.sleep(num)
    print &apos;Process:&apos;, num

if __name__ == &apos;__main__&apos;:
    for i in range(5):
        p = multiprocessing.Process(target=process, args=(i,))
        p.start()

    print(&apos;CPU number:&apos; + str(multiprocessing.cpu_count()))
    for p in multiprocessing.active_children():
        print(&apos;Child process name: &apos; + p.name + &apos; id: &apos; + str(p.pid))

    print(&apos;Process Ended&apos;)
</code></pre><p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Process: 0
CPU number:8
Child process name: Process-2 id: 9641
Child process name: Process-4 id: 9643
Child process name: Process-5 id: 9644
Child process name: Process-3 id: 9642
Process Ended
Process: 1
Process: 2
Process: 3
Process: 4
</code></pre><h3 id="&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;">&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;</h3>
<p>&#x53E6;&#x5916;&#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x7EE7;&#x627F;Process&#x7C7B;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;&#x8FDB;&#x7A0B;&#x7C7B;&#xFF0C;&#x5B9E;&#x73B0;run&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x611F;&#x53D7;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code>from multiprocessing import Process
import time


class MyProcess(Process):
    def __init__(self, loop):
        Process.__init__(self)
        self.loop = loop

    def run(self):
        for count in range(self.loop):
            time.sleep(1)
            print(&apos;Pid: &apos; + str(self.pid) + &apos; LoopCount: &apos; + str(count))


if __name__ == &apos;__main__&apos;:
    for i in range(2, 5):
        p = MyProcess(i)
        p.start()
</code></pre><p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7EE7;&#x627F;&#x4E86; Process &#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C;&#x7136;&#x540E;&#x5B9E;&#x73B0;&#x4E86;run&#x65B9;&#x6CD5;&#x3002;&#x6253;&#x5370;&#x51FA;&#x6765;&#x4E86;&#x8FDB;&#x7A0B;&#x53F7;&#x548C;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Pid: 28116 LoopCount: 0
Pid: 28117 LoopCount: 0
Pid: 28118 LoopCount: 0
Pid: 28116 LoopCount: 1
Pid: 28117 LoopCount: 1
Pid: 28118 LoopCount: 1
Pid: 28117 LoopCount: 2
Pid: 28118 LoopCount: 2
Pid: 28118 LoopCount: 3
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x4E09;&#x4E2A;&#x8FDB;&#x7A0B;&#x5206;&#x522B;&#x6253;&#x5370;&#x51FA;&#x4E86;2&#x3001;3&#x3001;4&#x6761;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x628A;&#x4E00;&#x4E9B;&#x65B9;&#x6CD5;&#x72EC;&#x7ACB;&#x7684;&#x5199;&#x5728;&#x6BCF;&#x4E2A;&#x7C7B;&#x91CC;&#x5C01;&#x88C5;&#x597D;&#xFF0C;&#x7B49;&#x7528;&#x7684;&#x65F6;&#x5019;&#x76F4;&#x63A5;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x7C7B;&#x8FD0;&#x884C;&#x5373;&#x53EF;&#x3002;</p>
<h3 id="deamon">deamon</h3>
<p>&#x5728;&#x8FD9;&#x91CC;&#x4ECB;&#x7ECD;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;&#xFF0C;&#x53EB;&#x505A;deamon&#x3002;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x5355;&#x72EC;&#x8BBE;&#x7F6E;&#x5B83;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E3A;True&#xFF0C;&#x5F53;&#x7236;&#x8FDB;&#x7A0B;&#x7ED3;&#x675F;&#x540E;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x81EA;&#x52A8;&#x88AB;&#x7EC8;&#x6B62;&#x3002;</p>
<p>&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x611F;&#x53D7;&#x4E00;&#x4E0B;&#xFF0C;&#x8FD8;&#x662F;&#x539F;&#x6765;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x589E;&#x52A0;&#x4E86;deamon&#x5C5E;&#x6027;&#xFF1A;</p>
<pre><code>from multiprocessing import Process
import time


class MyProcess(Process):
    def __init__(self, loop):
        Process.__init__(self)
        self.loop = loop

    def run(self):
        for count in range(self.loop):
            time.sleep(1)
            print(&apos;Pid: &apos; + str(self.pid) + &apos; LoopCount: &apos; + str(count))


if __name__ == &apos;__main__&apos;:
    for i in range(2, 5):
        p = MyProcess(i)
        p.daemon = True
        p.start()


    print &apos;Main process Ended!&apos;
</code></pre><p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x589E;&#x52A0;&#x4E86;&#x8BBE;&#x7F6E;deamon&#xFF0C;&#x6700;&#x540E;&#x7684;&#x4E3B;&#x8FDB;&#x7A0B;&#xFF08;&#x5373;&#x7236;&#x8FDB;&#x7A0B;&#xFF09;&#x6253;&#x5370;&#x8F93;&#x51FA;&#x4E86;&#x4E00;&#x53E5;&#x8BDD;&#x3002;</p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Main process Ended!
</code></pre><p>&#x7ED3;&#x679C;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x56E0;&#x4E3A;&#x4E3B;&#x8FDB;&#x7A0B;&#x6CA1;&#x6709;&#x505A;&#x4EFB;&#x4F55;&#x4E8B;&#x60C5;&#xFF0C;&#x76F4;&#x63A5;&#x8F93;&#x51FA;&#x4E00;&#x53E5;&#x8BDD;&#x7ED3;&#x675F;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x65F6;&#x4E5F;&#x76F4;&#x63A5;&#x7EC8;&#x6B62;&#x4E86;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x6709;&#x6548;&#x9632;&#x6B62;&#x65E0;&#x63A7;&#x5236;&#x5730;&#x751F;&#x6210;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x679C;&#x8FD9;&#x6837;&#x5199;&#x4E86;&#xFF0C;&#x4F60;&#x5728;&#x5173;&#x95ED;&#x8FD9;&#x4E2A;&#x4E3B;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x5C31;&#x65E0;&#x9700;&#x989D;&#x5916;&#x62C5;&#x5FC3;&#x5B50;&#x8FDB;&#x7A0B;&#x6709;&#x6CA1;&#x6709;&#x88AB;&#x5173;&#x95ED;&#x4E86;&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#x8FD9;&#x6837;&#x5E76;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x8FBE;&#x5230;&#x7684;&#x6548;&#x679C;&#x5440;&#xFF0C;&#x80FD;&#x4E0D;&#x80FD;&#x8BA9;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x6267;&#x884C;&#x5B8C;&#x4E86;&#x7136;&#x540E;&#x518D;&#x7ED3;&#x675F;&#x5462;&#xFF1F;&#x90A3;&#x5F53;&#x7136;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x52A0;&#x5165;join()&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;</p>
<pre><code>from multiprocessing import Process
import time


class MyProcess(Process):
    def __init__(self, loop):
        Process.__init__(self)
        self.loop = loop

    def run(self):
        for count in range(self.loop):
            time.sleep(1)
            print(&apos;Pid: &apos; + str(self.pid) + &apos; LoopCount: &apos; + str(count))


if __name__ == &apos;__main__&apos;:
    for i in range(2, 5):
        p = MyProcess(i)
        p.daemon = True
        p.start()
        p.join()


    print &apos;Main process Ended!&apos;
</code></pre><p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x8C03;&#x7528;&#x4E86;join()&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x6837;&#x7236;&#x8FDB;&#x7A0B;&#xFF08;&#x4E3B;&#x8FDB;&#x7A0B;&#xFF09;&#x5C31;&#x4F1A;&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x3002;</p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Pid: 29902 LoopCount: 0
Pid: 29902 LoopCount: 1
Pid: 29905 LoopCount: 0
Pid: 29905 LoopCount: 1
Pid: 29905 LoopCount: 2
Pid: 29912 LoopCount: 0
Pid: 29912 LoopCount: 1
Pid: 29912 LoopCount: 2
Pid: 29912 LoopCount: 3
Main process Ended!
</code></pre><p>&#x53D1;&#x73B0;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x4E4B;&#x540E;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x6700;&#x540E;&#x6253;&#x5370;&#x51FA;&#x4E86;&#x7ED3;&#x675F;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<h2 id="lock">Lock</h2>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x5B9E;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x9047;&#x5230;&#x5982;&#x4E0B;&#x7684;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<p><img src="../image/chapter4/section6-1.jpg" alt=""></p>
<p>&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#xFF1F;&#x6709;&#x7684;&#x8F93;&#x51FA;&#x9519;&#x4F4D;&#x4E86;&#x3002;&#x8FD9;&#x662F;&#x7531;&#x4E8E;&#x5E76;&#x884C;&#x5BFC;&#x81F4;&#x7684;&#xFF0C;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x540C;&#x65F6;&#x8FDB;&#x884C;&#x4E86;&#x8F93;&#x51FA;&#xFF0C;&#x7ED3;&#x679C;&#x7B2C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x6362;&#x884C;&#x6CA1;&#x6709;&#x6765;&#x5F97;&#x53CA;&#x8F93;&#x51FA;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x8FDB;&#x7A0B;&#x5C31;&#x8F93;&#x51FA;&#x4E86;&#x7ED3;&#x679C;&#x3002;&#x6240;&#x4EE5;&#x5BFC;&#x81F4;&#x8FD9;&#x79CD;&#x6392;&#x7248;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x90A3;&#x8FD9;&#x5F52;&#x6839;&#x7ED3;&#x5E95;&#x662F;&#x56E0;&#x4E3A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x8D44;&#x6E90;&#xFF08;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#xFF09;&#x800C;&#x5BFC;&#x81F4;&#x7684;&#x3002;</p>
<p>&#x90A3;&#x600E;&#x4E48;&#x6765;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x95EE;&#x9898;&#xFF1F;&#x90A3;&#x81EA;&#x7136;&#x662F;&#x5728;&#x67D0;&#x4E00;&#x65F6;&#x95F4;&#xFF0C;&#x53EA;&#x80FD;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8F93;&#x51FA;&#xFF0C;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7B49;&#x5F85;&#x3002;&#x7B49;&#x521A;&#x624D;&#x90A3;&#x4E2A;&#x8FDB;&#x7A0B;&#x8F93;&#x51FA;&#x5B8C;&#x6BD5;&#x4E4B;&#x540E;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x518D;&#x8FDB;&#x884C;&#x8F93;&#x51FA;&#x3002;&#x8FD9;&#x79CD;&#x73B0;&#x8C61;&#x5C31;&#x53EB;&#x505A;&#x201C;&#x4E92;&#x65A5;&#x201D;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; Lock &#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x5728;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8F93;&#x51FA;&#x65F6;&#xFF0C;&#x52A0;&#x9501;&#xFF0C;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7B49;&#x5F85;&#x3002;&#x7B49;&#x6B64;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x540E;&#xFF0C;&#x91CA;&#x653E;&#x9501;&#xFF0C;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x8F93;&#x51FA;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x73B0;&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x611F;&#x53D7;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code>from multiprocessing import Process, Lock
import time


class MyProcess(Process):
    def __init__(self, loop, lock):
        Process.__init__(self)
        self.loop = loop
        self.lock = lock

    def run(self):
        for count in range(self.loop):
            time.sleep(0.1)
            #self.lock.acquire()
            print(&apos;Pid: &apos; + str(self.pid) + &apos; LoopCount: &apos; + str(count))
            #self.lock.release()

if __name__ == &apos;__main__&apos;:
    lock = Lock()
    for i in range(10, 15):
        p = MyProcess(i, lock)
        p.start()
</code></pre><p>&#x9996;&#x5148;&#x770B;&#x4E00;&#x4E0B;&#x4E0D;&#x52A0;&#x9501;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Pid: 45755 LoopCount: 0
Pid: 45756 LoopCount: 0
Pid: 45757 LoopCount: 0
Pid: 45758 LoopCount: 0
Pid: 45759 LoopCount: 0
Pid: 45755 LoopCount: 1
Pid: 45756 LoopCount: 1
Pid: 45757 LoopCount: 1
Pid: 45758 LoopCount: 1
Pid: 45759 LoopCount: 1
Pid: 45755 LoopCount: 2Pid: 45756 LoopCount: 2

Pid: 45757 LoopCount: 2
Pid: 45758 LoopCount: 2
Pid: 45759 LoopCount: 2
Pid: 45756 LoopCount: 3
Pid: 45755 LoopCount: 3
Pid: 45757 LoopCount: 3
Pid: 45758 LoopCount: 3
Pid: 45759 LoopCount: 3
Pid: 45755 LoopCount: 4
Pid: 45756 LoopCount: 4
Pid: 45757 LoopCount: 4
Pid: 45759 LoopCount: 4
Pid: 45758 LoopCount: 4
Pid: 45756 LoopCount: 5
Pid: 45755 LoopCount: 5
Pid: 45757 LoopCount: 5
Pid: 45759 LoopCount: 5
Pid: 45758 LoopCount: 5
Pid: 45756 LoopCount: 6Pid: 45755 LoopCount: 6

Pid: 45757 LoopCount: 6
Pid: 45759 LoopCount: 6
Pid: 45758 LoopCount: 6
Pid: 45755 LoopCount: 7Pid: 45756 LoopCount: 7

Pid: 45757 LoopCount: 7
Pid: 45758 LoopCount: 7
Pid: 45759 LoopCount: 7
Pid: 45756 LoopCount: 8Pid: 45755 LoopCount: 8

Pid: 45757 LoopCount: 8
Pid: 45758 LoopCount: 8Pid: 45759 LoopCount: 8

Pid: 45755 LoopCount: 9
Pid: 45756 LoopCount: 9
Pid: 45757 LoopCount: 9
Pid: 45758 LoopCount: 9
Pid: 45759 LoopCount: 9
Pid: 45756 LoopCount: 10
Pid: 45757 LoopCount: 10
Pid: 45758 LoopCount: 10
Pid: 45759 LoopCount: 10
Pid: 45757 LoopCount: 11
Pid: 45758 LoopCount: 11
Pid: 45759 LoopCount: 11
Pid: 45758 LoopCount: 12
Pid: 45759 LoopCount: 12
Pid: 45759 LoopCount: 13
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6709;&#x4E9B;&#x8F93;&#x51FA;&#x5DF2;&#x7ECF;&#x9020;&#x6210;&#x4E86;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5BF9;&#x5176;&#x52A0;&#x9501;&#xFF1A;</p>
<pre><code>from multiprocessing import Process, Lock
import time


class MyProcess(Process):
    def __init__(self, loop, lock):
        Process.__init__(self)
        self.loop = loop
        self.lock = lock

    def run(self):
        for count in range(self.loop):
            time.sleep(0.1)
            self.lock.acquire()
            print(&apos;Pid: &apos; + str(self.pid) + &apos; LoopCount: &apos; + str(count))
            self.lock.release()

if __name__ == &apos;__main__&apos;:
    lock = Lock()
    for i in range(10, 15):
        p = MyProcess(i, lock)
        p.start()
</code></pre><p>&#x6211;&#x4EEC;&#x5728;print&#x65B9;&#x6CD5;&#x7684;&#x524D;&#x540E;&#x5206;&#x522B;&#x6DFB;&#x52A0;&#x4E86;&#x83B7;&#x5F97;&#x9501;&#x548C;&#x91CA;&#x653E;&#x9501;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x4FDD;&#x8BC1;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x53EA;&#x6709;&#x4E00;&#x4E2A;print&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x770B;&#x4E00;&#x4E0B;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Pid: 45889 LoopCount: 0
Pid: 45890 LoopCount: 0
Pid: 45891 LoopCount: 0
Pid: 45892 LoopCount: 0
Pid: 45893 LoopCount: 0
Pid: 45889 LoopCount: 1
Pid: 45890 LoopCount: 1
Pid: 45891 LoopCount: 1
Pid: 45892 LoopCount: 1
Pid: 45893 LoopCount: 1
Pid: 45889 LoopCount: 2
Pid: 45890 LoopCount: 2
Pid: 45891 LoopCount: 2
Pid: 45892 LoopCount: 2
Pid: 45893 LoopCount: 2
Pid: 45889 LoopCount: 3
Pid: 45890 LoopCount: 3
Pid: 45891 LoopCount: 3
Pid: 45892 LoopCount: 3
Pid: 45893 LoopCount: 3
Pid: 45889 LoopCount: 4
Pid: 45890 LoopCount: 4
Pid: 45891 LoopCount: 4
Pid: 45892 LoopCount: 4
Pid: 45893 LoopCount: 4
Pid: 45889 LoopCount: 5
Pid: 45890 LoopCount: 5
Pid: 45891 LoopCount: 5
Pid: 45892 LoopCount: 5
Pid: 45893 LoopCount: 5
Pid: 45889 LoopCount: 6
Pid: 45890 LoopCount: 6
Pid: 45891 LoopCount: 6
Pid: 45893 LoopCount: 6
Pid: 45892 LoopCount: 6
Pid: 45889 LoopCount: 7
Pid: 45890 LoopCount: 7
Pid: 45891 LoopCount: 7
Pid: 45892 LoopCount: 7
Pid: 45893 LoopCount: 7
Pid: 45889 LoopCount: 8
Pid: 45890 LoopCount: 8
Pid: 45891 LoopCount: 8
Pid: 45892 LoopCount: 8
Pid: 45893 LoopCount: 8
Pid: 45889 LoopCount: 9
Pid: 45890 LoopCount: 9
Pid: 45891 LoopCount: 9
Pid: 45892 LoopCount: 9
Pid: 45893 LoopCount: 9
Pid: 45890 LoopCount: 10
Pid: 45891 LoopCount: 10
Pid: 45892 LoopCount: 10
Pid: 45893 LoopCount: 10
Pid: 45891 LoopCount: 11
Pid: 45892 LoopCount: 11
Pid: 45893 LoopCount: 11
Pid: 45893 LoopCount: 12
Pid: 45892 LoopCount: 12
Pid: 45893 LoopCount: 13
`
</code></pre><p>&#x55EF;&#xFF0C;&#x4E00;&#x5207;&#x90FD;&#x6CA1;&#x95EE;&#x9898;&#x4E86;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x5728;&#x8BBF;&#x95EE;&#x4E34;&#x754C;&#x8D44;&#x6E90;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;Lock&#x5C31;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x8FDB;&#x7A0B;&#x540C;&#x65F6;&#x5360;&#x7528;&#x8D44;&#x6E90;&#x800C;&#x5BFC;&#x81F4;&#x7684;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#x3002;</p>
<h2 id="semaphore">Semaphore</h2>
<p>&#x4FE1;&#x53F7;&#x91CF;&#xFF0C;&#x662F;&#x5728;&#x8FDB;&#x7A0B;&#x540C;&#x6B65;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x89D2;&#x8272;&#x3002;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x4E34;&#x754C;&#x8D44;&#x6E90;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x4FDD;&#x8BC1;&#x5404;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x4E92;&#x65A5;&#x548C;&#x540C;&#x6B65;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x5B66;&#x8FC7;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x5B9A;&#x5BF9;&#x8FD9;&#x65B9;&#x9762;&#x975E;&#x5E38;&#x4E86;&#x89E3;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x8FD8;&#x4E0D;&#x4E86;&#x89E3;&#x4FE1;&#x53F7;&#x91CF;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;<a href="http://blog.csdn.net/qinxiongxu/article/details/7830537" target="_blank">&#x4FE1;&#x53F7;&#x91CF;&#x89E3;&#x6790;</a></p>
<p>&#x6765;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;&#x5B83;&#x662F;&#x505A;&#x4EC0;&#x4E48;&#x7684;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5C31;&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x6F14;&#x793A;&#x4E00;&#x4E0B;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x5229;&#x7528;Semaphore&#x505A;&#x5230;&#x540C;&#x6B65;&#x548C;&#x4E92;&#x65A5;&#xFF0C;&#x4EE5;&#x53CA;&#x63A7;&#x5236;&#x4E34;&#x754C;&#x8D44;&#x6E90;&#x6570;&#x91CF;&#x3002;</p>
<pre><code>from multiprocessing import Process, Semaphore, Lock, Queue
import time

buffer = Queue(10)
empty = Semaphore(2)
full = Semaphore(0)
lock = Lock()

class Consumer(Process):

    def run(self):
        global buffer, empty, full, lock
        while True:
            full.acquire()
            lock.acquire()
            buffer.get()
            print(&apos;Consumer pop an element&apos;)
            time.sleep(1)
            lock.release()
            empty.release()


class Producer(Process):
    def run(self):
        global buffer, empty, full, lock
        while True:
            empty.acquire()
            lock.acquire()
            buffer.put(1)
            print(&apos;Producer append an element&apos;)
            time.sleep(1)
            lock.release()
            full.release()


if __name__ == &apos;__main__&apos;:
    p = Producer()
    c = Consumer()
    p.daemon = c.daemon = True
    p.start()
    c.start()
    p.join()
    c.join()
    print &apos;Ended!&apos;
</code></pre><p>&#x5982;&#x4E0A;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x4E86;&#x6CE8;&#x660E;&#x7684;&#x751F;&#x4EA7;&#x8005;&#x548C;&#x6D88;&#x8D39;&#x8005;&#x95EE;&#x9898;&#xFF0C;&#x5B9A;&#x4E49;&#x4E86;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x7C7B;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x6D88;&#x8D39;&#x8005;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x751F;&#x4EA7;&#x8005;&#x3002;</p>
<p>&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x961F;&#x5217;&#xFF0C;&#x5229;&#x7528;&#x4E86;Queue&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x7136;&#x540E;&#x5B9A;&#x4E49;&#x4E86;&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;&#x91CF;&#xFF0C;&#x4E00;&#x4E2A;&#x4EE3;&#x8868;&#x7F13;&#x51B2;&#x533A;&#x7A7A;&#x4F59;&#x6570;&#xFF0C;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x7F13;&#x51B2;&#x533A;&#x5360;&#x7528;&#x6570;&#x3002;</p>
<p>&#x751F;&#x4EA7;&#x8005;Producer&#x4F7F;&#x7528;empty.acquire()&#x65B9;&#x6CD5;&#x6765;&#x5360;&#x7528;&#x4E00;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x4F4D;&#x7F6E;&#xFF0C;&#x7136;&#x540E;&#x7F13;&#x51B2;&#x533A;&#x7A7A;&#x95F2;&#x533A;&#x5927;&#x5C0F;&#x51CF;&#x5C0F;1&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x8FDB;&#x884C;&#x52A0;&#x9501;&#xFF0C;&#x5BF9;&#x7F13;&#x51B2;&#x533A;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x3002;&#x7136;&#x540E;&#x91CA;&#x653E;&#x9501;&#xFF0C;&#x7136;&#x540E;&#x8BA9;&#x4EE3;&#x8868;&#x5360;&#x7528;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x4F4D;&#x7F6E;&#x6570;&#x91CF;+1&#xFF0C;&#x6D88;&#x8D39;&#x8005;&#x5219;&#x76F8;&#x53CD;&#x3002;</p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>Producer append an element
Producer append an element
Consumer pop an element
Consumer pop an element
Producer append an element
Producer append an element
Consumer pop an element
Consumer pop an element
Producer append an element
Producer append an element
Consumer pop an element
Consumer pop an element
Producer append an element
Producer append an element
</code></pre><p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x5728;&#x4EA4;&#x66FF;&#x8FD0;&#x884C;&#xFF0C;&#x751F;&#x4EA7;&#x8005;&#x5148;&#x653E;&#x5165;&#x7F13;&#x51B2;&#x533A;&#x7269;&#x54C1;&#xFF0C;&#x7136;&#x540E;&#x6D88;&#x8D39;&#x8005;&#x53D6;&#x51FA;&#xFF0C;&#x4E0D;&#x505C;&#x5730;&#x8FDB;&#x884C;&#x5FAA;&#x73AF;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6765;&#x4F53;&#x4F1A;&#x4E00;&#x4E0B;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x7528;&#x6CD5;&#x3002;</p>
<h2 id="queue">Queue</h2>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;Queue&#xFF0C;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x8FDB;&#x7A0B;&#x901A;&#x4FE1;&#x7684;&#x5171;&#x4EAB;&#x961F;&#x5217;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x628A;Queue&#x6362;&#x6210;&#x666E;&#x901A;&#x7684;list&#xFF0C;&#x662F;&#x5B8C;&#x5168;&#x8D77;&#x4E0D;&#x5230;&#x6548;&#x679C;&#x7684;&#x3002;&#x5373;&#x4F7F;&#x5728;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x6539;&#x53D8;&#x4E86;&#x8FD9;&#x4E2A;list&#xFF0C;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E5F;&#x4E0D;&#x80FD;&#x83B7;&#x53D6;&#x5230;&#x5B83;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#xFF0C;&#x961F;&#x5217;&#x9700;&#x8981;&#x7528;Queue&#x3002;&#x5F53;&#x7136;&#x8FD9;&#x91CC;&#x7684;&#x961F;&#x5217;&#x6307;&#x7684;&#x662F; multiprocessing.Queue</p>
<p>&#x4F9D;&#x7136;&#x662F;&#x7528;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x6211;&#x4EEC;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5411;&#x961F;&#x5217;&#x4E2D;&#x653E;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53D6;&#x51FA;&#x6570;&#x636E;&#x3002;</p>
<pre><code>from multiprocessing import Process, Semaphore, Lock, Queue
import time
from random import random

buffer = Queue(10)
empty = Semaphore(2)
full = Semaphore(0)
lock = Lock()

class Consumer(Process):

    def run(self):
        global buffer, empty, full, lock
        while True:
            full.acquire()
            lock.acquire()
            print &apos;Consumer get&apos;, buffer.get()
            time.sleep(1)
            lock.release()
            empty.release()


class Producer(Process):
    def run(self):
        global buffer, empty, full, lock
        while True:
            empty.acquire()
            lock.acquire()
            num = random()
            print &apos;Producer put &apos;, num
            buffer.put(num)
            time.sleep(1)
            lock.release()
            full.release()


if __name__ == &apos;__main__&apos;:
    p = Producer()
    c = Consumer()
    p.daemon = c.daemon = True
    p.start()
    c.start()
    p.join()
    c.join()
    print &apos;Ended!&apos;
</code></pre><p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Producer put  0.719213647437
Producer put  0.44287326683
Consumer get 0.719213647437
Consumer get 0.44287326683
Producer put  0.722859424381
Producer put  0.525321338921
Consumer get 0.722859424381
Consumer get 0.525321338921
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x751F;&#x4EA7;&#x8005;&#x653E;&#x5165;&#x961F;&#x5217;&#x4E2D;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x6D88;&#x8D39;&#x8005;&#x5C06;&#x6570;&#x636E;&#x53D6;&#x51FA;&#x6765;&#x3002;</p>
<p>get&#x65B9;&#x6CD5;&#x6709;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;blocked&#x548C;timeout&#xFF0C;&#x610F;&#x601D;&#x4E3A;&#x963B;&#x585E;&#x548C;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x3002;&#x9ED8;&#x8BA4;blocked&#x662F;true&#xFF0C;&#x5373;&#x963B;&#x585E;&#x5F0F;&#x3002;</p>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x961F;&#x5217;&#x4E3A;&#x7A7A;&#x7684;&#x65F6;&#x5019;&#x5982;&#x679C;&#x518D;&#x7528;get&#x53D6;&#x5219;&#x4F1A;&#x963B;&#x585E;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x65F6;&#x5019;&#x5C31;&#x9700;&#x8981;&#x5427;blocked&#x8BBE;&#x7F6E;&#x4E3A;false&#xFF0C;&#x5373;&#x975E;&#x963B;&#x585E;&#x5F0F;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5B83;&#x5C31;&#x4F1A;&#x8C03;&#x7528;get_nowait()&#x65B9;&#x6CD5;&#xFF0C;&#x6B64;&#x65F6;&#x8FD8;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#xFF0C;&#x5728;&#x8FD9;&#x4E48;&#x957F;&#x7684;&#x65F6;&#x95F4;&#x5185;&#x8FD8;&#x6CA1;&#x6709;&#x53D6;&#x5230;&#x961F;&#x5217;&#x5143;&#x7D20;&#xFF0C;&#x90A3;&#x5C31;&#x629B;&#x51FA;Queue.Empty&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x961F;&#x5217;&#x4E3A;&#x6EE1;&#x7684;&#x65F6;&#x5019;&#x5982;&#x679C;&#x518D;&#x7528;put&#x653E;&#x5219;&#x4F1A;&#x963B;&#x585E;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x65F6;&#x5019;&#x5C31;&#x9700;&#x8981;&#x5427;blocked&#x8BBE;&#x7F6E;&#x4E3A;false&#xFF0C;&#x5373;&#x975E;&#x963B;&#x585E;&#x5F0F;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5B83;&#x5C31;&#x4F1A;&#x8C03;&#x7528;put_nowait()&#x65B9;&#x6CD5;&#xFF0C;&#x6B64;&#x65F6;&#x8FD8;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#xFF0C;&#x5728;&#x8FD9;&#x4E48;&#x957F;&#x7684;&#x65F6;&#x95F4;&#x5185;&#x8FD8;&#x6CA1;&#x6709;&#x653E;&#x8FDB;&#x53BB;&#x5143;&#x7D20;&#xFF0C;&#x90A3;&#x5C31;&#x629B;&#x51FA;Queue.Full&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x53E6;&#x5916;&#x961F;&#x5217;&#x4E2D;&#x5E38;&#x7528;&#x7684;&#x65B9;&#x6CD5;</p>
<p>Queue.qsize() &#x8FD4;&#x56DE;&#x961F;&#x5217;&#x7684;&#x5927;&#x5C0F; &#xFF0C;&#x4E0D;&#x8FC7;&#x5728; Mac OS &#x4E0A;&#x6CA1;&#x6CD5;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x539F;&#x56E0;&#xFF1A;</p>
<blockquote>
<p>def qsize(self):
<code>#</code>Raises NotImplementedError on Mac OSX because of broken sem_getvalue()
return self._maxsize &#x2013; self._sem._semlock._get_value()</p>
</blockquote>
<p>Queue.empty() &#x5982;&#x679C;&#x961F;&#x5217;&#x4E3A;&#x7A7A;&#xFF0C;&#x8FD4;&#x56DE;True, &#x53CD;&#x4E4B;False</p>
<p>Queue.full() &#x5982;&#x679C;&#x961F;&#x5217;&#x6EE1;&#x4E86;&#xFF0C;&#x8FD4;&#x56DE;True,&#x53CD;&#x4E4B;False</p>
<p>Queue.get([block[, timeout]]) &#x83B7;&#x53D6;&#x961F;&#x5217;&#xFF0C;timeout&#x7B49;&#x5F85;&#x65F6;&#x95F4;</p>
<p>Queue.get_nowait() &#x76F8;&#x5F53;Queue.get(False)</p>
<p>Queue.put(item) &#x963B;&#x585E;&#x5F0F;&#x5199;&#x5165;&#x961F;&#x5217;&#xFF0C;timeout&#x7B49;&#x5F85;&#x65F6;&#x95F4;</p>
<p>Queue.put_nowait(item) &#x76F8;&#x5F53;Queue.put(item, False)</p>
<h2 id="pipe">Pipe</h2>
<p>&#x7BA1;&#x9053;&#xFF0C;&#x987E;&#x540D;&#x601D;&#x4E49;&#xFF0C;&#x4E00;&#x7AEF;&#x53D1;&#x4E00;&#x7AEF;&#x6536;&#x3002;</p>
<p>Pipe&#x53EF;&#x4EE5;&#x662F;&#x5355;&#x5411;(half-duplex)&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x53CC;&#x5411;(duplex)&#x3002;&#x6211;&#x4EEC;&#x901A;&#x8FC7;mutiprocessing.Pipe(duplex=False)&#x521B;&#x5EFA;&#x5355;&#x5411;&#x7BA1;&#x9053; (&#x9ED8;&#x8BA4;&#x4E3A;&#x53CC;&#x5411;)&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4ECE;PIPE&#x4E00;&#x7AEF;&#x8F93;&#x5165;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x88AB;PIPE&#x53E6;&#x4E00;&#x7AEF;&#x7684;&#x8FDB;&#x7A0B;&#x63A5;&#x6536;&#xFF0C;&#x5355;&#x5411;&#x7BA1;&#x9053;&#x53EA;&#x5141;&#x8BB8;&#x7BA1;&#x9053;&#x4E00;&#x7AEF;&#x7684;&#x8FDB;&#x7A0B;&#x8F93;&#x5165;&#xFF0C;&#x800C;&#x53CC;&#x5411;&#x7BA1;&#x9053;&#x5219;&#x5141;&#x8BB8;&#x4ECE;&#x4E24;&#x7AEF;&#x8F93;&#x5165;&#x3002;</p>
<p>&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x611F;&#x53D7;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code>from multiprocessing import Process, Pipe


class Consumer(Process):
    def __init__(self, pipe):
        Process.__init__(self)
        self.pipe = pipe

    def run(self):
        self.pipe.send(&apos;Consumer Words&apos;)
        print &apos;Consumer Received:&apos;, self.pipe.recv()


class Producer(Process):
    def __init__(self, pipe):
        Process.__init__(self)
        self.pipe = pipe

    def run(self):
        print &apos;Producer Received:&apos;, self.pipe.recv()
        self.pipe.send(&apos;Producer Words&apos;)


if __name__ == &apos;__main__&apos;:
    pipe = Pipe()
    p = Producer(pipe[0])
    c = Consumer(pipe[1])
    p.daemon = c.daemon = True
    p.start()
    c.start()
    p.join()
    c.join()
    print &apos;Ended!&apos;
</code></pre><p>&#x5728;&#x8FD9;&#x91CC;&#x58F0;&#x660E;&#x4E86;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x4E3A;&#x53CC;&#x5411;&#x7684;&#x7BA1;&#x9053;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x7BA1;&#x9053;&#x7684;&#x4E24;&#x7AEF;&#x5206;&#x522B;&#x4F20;&#x7ED9;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E92;&#x76F8;&#x6536;&#x53D1;&#x3002;&#x89C2;&#x5BDF;&#x4E00;&#x4E0B;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Producer Received: Consumer Words
Consumer Received: Producer Words
Ended!
</code></pre><p>&#x4EE5;&#x4E0A;&#x662F;&#x5BF9;pipe&#x7684;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x3002;</p>
<h2 id="pool">Pool</h2>
<p>&#x5728;&#x5229;&#x7528;Python&#x8FDB;&#x884C;&#x7CFB;&#x7EDF;&#x7BA1;&#x7406;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x540C;&#x65F6;&#x64CD;&#x4F5C;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x76EE;&#x5F55;&#xFF0C;&#x6216;&#x8005;&#x8FDC;&#x7A0B;&#x63A7;&#x5236;&#x591A;&#x53F0;&#x4E3B;&#x673A;&#xFF0C;&#x5E76;&#x884C;&#x64CD;&#x4F5C;&#x53EF;&#x4EE5;&#x8282;&#x7EA6;&#x5927;&#x91CF;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x5F53;&#x88AB;&#x64CD;&#x4F5C;&#x5BF9;&#x8C61;&#x6570;&#x76EE;&#x4E0D;&#x5927;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5229;&#x7528;multiprocessing&#x4E2D;&#x7684;Process&#x52A8;&#x6001;&#x6210;&#x751F;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5341;&#x51E0;&#x4E2A;&#x8FD8;&#x597D;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x662F;&#x4E0A;&#x767E;&#x4E2A;&#xFF0C;&#x4E0A;&#x5343;&#x4E2A;&#x76EE;&#x6807;&#xFF0C;&#x624B;&#x52A8;&#x7684;&#x53BB;&#x9650;&#x5236;&#x8FDB;&#x7A0B;&#x6570;&#x91CF;&#x5374;&#x53C8;&#x592A;&#x8FC7;&#x7E41;&#x7410;&#xFF0C;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x53D1;&#x6325;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x529F;&#x6548;&#x3002;
Pool&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x6307;&#x5B9A;&#x6570;&#x91CF;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x4F9B;&#x7528;&#x6237;&#x8C03;&#x7528;&#xFF0C;&#x5F53;&#x6709;&#x65B0;&#x7684;&#x8BF7;&#x6C42;&#x63D0;&#x4EA4;&#x5230;pool&#x4E2D;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x6C60;&#x8FD8;&#x6CA1;&#x6709;&#x6EE1;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x8FDB;&#x7A0B;&#x7528;&#x6765;&#x6267;&#x884C;&#x8BE5;&#x8BF7;&#x6C42;&#xFF1B;&#x4F46;&#x5982;&#x679C;&#x6C60;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x6570;&#x5DF2;&#x7ECF;&#x8FBE;&#x5230;&#x89C4;&#x5B9A;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x8BF7;&#x6C42;&#x5C31;&#x4F1A;&#x7B49;&#x5F85;&#xFF0C;&#x76F4;&#x5230;&#x6C60;&#x4E2D;&#x6709;&#x8FDB;&#x7A0B;&#x7ED3;&#x675F;&#xFF0C;&#x624D;&#x4F1A;&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x8FDB;&#x7A0B;&#x6765;&#x5B83;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x963B;&#x585E;&#x548C;&#x975E;&#x963B;&#x585E;&#x7684;&#x6982;&#x5FF5;&#x3002;</p>
<p>&#x963B;&#x585E;&#x548C;&#x975E;&#x963B;&#x585E;&#x5173;&#x6CE8;&#x7684;&#x662F;&#x7A0B;&#x5E8F;&#x5728;&#x7B49;&#x5F85;&#x8C03;&#x7528;&#x7ED3;&#x679C;&#xFF08;&#x6D88;&#x606F;&#xFF0C;&#x8FD4;&#x56DE;&#x503C;&#xFF09;&#x65F6;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x963B;&#x585E;&#x5373;&#x8981;&#x7B49;&#x5230;&#x56DE;&#x8C03;&#x7ED3;&#x679C;&#x51FA;&#x6765;&#xFF0C;&#x5728;&#x6709;&#x7ED3;&#x679C;&#x4E4B;&#x524D;&#xFF0C;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x4F1A;&#x88AB;&#x6302;&#x8D77;&#x3002;</p>
<p>Pool&#x7684;&#x7528;&#x6CD5;&#x6709;&#x963B;&#x585E;&#x548C;&#x975E;&#x963B;&#x585E;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x3002;&#x975E;&#x963B;&#x585E;&#x5373;&#x4E3A;&#x6DFB;&#x52A0;&#x8FDB;&#x7A0B;&#x540E;&#xFF0C;&#x4E0D;&#x4E00;&#x5B9A;&#x975E;&#x8981;&#x7B49;&#x5230;&#x6539;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x5B8C;&#x5C31;&#x6DFB;&#x52A0;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x8FD0;&#x884C;&#xFF0C;&#x963B;&#x585E;&#x5219;&#x76F8;&#x53CD;&#x3002;</p>
<p>&#x73B0;&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x611F;&#x53D7;&#x4E00;&#x4E0B;&#x975E;&#x963B;&#x585E;&#x7684;&#x7528;&#x6CD5;&#xFF1A;</p>
<pre><code>from multiprocessing import Lock, Pool
import time


def function(index):
    print &apos;Start process: &apos;, index
    time.sleep(3)
    print &apos;End process&apos;, index


if __name__ == &apos;__main__&apos;:
    pool = Pool(processes=3)
    for i in xrange(4):
        pool.apply_async(function, (i,))

    print &quot;Started processes&quot;
    pool.close()
    pool.join()
    print &quot;Subprocess done.&quot;
</code></pre><p>&#x5728;&#x8FD9;&#x91CC;&#x5229;&#x7528;&#x4E86;apply_async&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x975E;&#x963B;&#x585E;&#x3002;</p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Started processes
Start process: Start process:  0 
1
Start process:  2
End processEnd process 0 
1
Start process:  3
End process 2
End process 3
Subprocess done.
</code></pre><p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x5728;&#x8FD9;&#x91CC;&#x6DFB;&#x52A0;&#x4E09;&#x4E2A;&#x8FDB;&#x7A0B;&#x8FDB;&#x53BB;&#x540E;&#xFF0C;&#x7ACB;&#x9A6C;&#x5C31;&#x5F00;&#x59CB;&#x6267;&#x884C;&#xFF0C;&#x4E0D;&#x7528;&#x975E;&#x8981;&#x7B49;&#x5230;&#x67D0;&#x4E2A;&#x8FDB;&#x7A0B;&#x7ED3;&#x675F;&#x540E;&#x518D;&#x6DFB;&#x52A0;&#x65B0;&#x7684;&#x8FDB;&#x7A0B;&#x8FDB;&#x53BB;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x518D;&#x770B;&#x770B;&#x963B;&#x585E;&#x7684;&#x7528;&#x6CD5;&#xFF1A;</p>
<pre><code>from multiprocessing import Lock, Pool
import time


def function(index):
    print &apos;Start process: &apos;, index
    time.sleep(3)
    print &apos;End process&apos;, index


if __name__ == &apos;__main__&apos;:
    pool = Pool(processes=3)
    for i in xrange(4):
        pool.apply(function, (i,))

    print &quot;Started processes&quot;
    pool.close()
    pool.join()
    print &quot;Subprocess done.&quot;
</code></pre><p>&#x5728;&#x8FD9;&#x91CC;&#x53EA;&#x9700;&#x8981;&#x628A;apply_async&#x6539;&#x6210;apply&#x5373;&#x53EF;&#x3002;</p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>Start process:  0
End process 0
Start process:  1
End process 1
Start process:  2
End process 2
Start process:  3
End process 3
Started processes
Subprocess done.
</code></pre><p>&#x8FD9;&#x6837;&#x4E00;&#x6765;&#x5C31;&#x597D;&#x7406;&#x89E3;&#x4E86;&#x5427;&#xFF1F;</p>
<p>&#x4E0B;&#x9762;&#x5BF9;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x89E3;&#x91CA;&#xFF1A;</p>
<p>apply_async(func[, args[, kwds[, callback]]]) &#x5B83;&#x662F;&#x975E;&#x963B;&#x585E;&#xFF0C;apply(func[, args[, kwds]])&#x662F;&#x963B;&#x585E;&#x7684;&#x3002;</p>
<p>close() &#x5173;&#x95ED;pool&#xFF0C;&#x4F7F;&#x5176;&#x4E0D;&#x5728;&#x63A5;&#x53D7;&#x65B0;&#x7684;&#x4EFB;&#x52A1;&#x3002;</p>
<p>terminate() &#x7ED3;&#x675F;&#x5DE5;&#x4F5C;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E0D;&#x5728;&#x5904;&#x7406;&#x672A;&#x5B8C;&#x6210;&#x7684;&#x4EFB;&#x52A1;&#x3002;</p>
<p>join() &#x4E3B;&#x8FDB;&#x7A0B;&#x963B;&#x585E;&#xFF0C;&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x9000;&#x51FA;&#xFF0C; join&#x65B9;&#x6CD5;&#x8981;&#x5728;close&#x6216;terminate&#x4E4B;&#x540E;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x5F53;&#x7136;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5728;&#x5404;&#x81EA;&#x7684;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#x3002;apply&#x6216;apply_async&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x62FF;&#x5230;&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x5E76;&#x8FDB;&#x4E00;&#x6B65;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;</p>
<pre><code>from multiprocessing import Lock, Pool
import time


def function(index):
    print &apos;Start process: &apos;, index
    time.sleep(3)
    print &apos;End process&apos;, index
    return index

if __name__ == &apos;__main__&apos;:
    pool = Pool(processes=3)
    for i in xrange(4):
        result = pool.apply_async(function, (i,))
        print result.get()
    print &quot;Started processes&quot;
    pool.close()
    pool.join()
    print &quot;Subprocess done.&quot;
</code></pre><p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>Start process:  0
End process 0
0
Start process:  1
End process 1
1
Start process:  2
End process 2
2
Start process:  3
End process 3
3
Started processes
Subprocess done.
</code></pre><p>&#x53E6;&#x5916;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x597D;&#x7528;&#x7684;map&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x73B0;&#x5728;&#x6709;&#x4E00;&#x5806;&#x6570;&#x636E;&#x8981;&#x5904;&#x7406;&#xFF0C;&#x6BCF;&#x4E00;&#x9879;&#x90FD;&#x9700;&#x8981;&#x7ECF;&#x8FC7;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x6765;&#x5904;&#x7406;&#xFF0C;&#x90A3;&#x4E48;map&#x975E;&#x5E38;&#x9002;&#x5408;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x73B0;&#x5728;&#x4F60;&#x6709;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x5305;&#x542B;&#x4E86;&#x6240;&#x6709;&#x7684;URL&#xFF0C;&#x800C;&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x7528;&#x6765;&#x6293;&#x53D6;&#x6BCF;&#x4E2A;URL&#x5185;&#x5BB9;&#x5E76;&#x89E3;&#x6790;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5728;map&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x65B9;&#x6CD5;&#x540D;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x4F20;&#x5165;URL&#x6570;&#x7EC4;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x611F;&#x53D7;&#x4E00;&#x4E0B;&#xFF1A;</p>
<pre><code>from multiprocessing import Pool
import requests
from requests.exceptions import ConnectionError


def scrape(url):
    try:
        print requests.get(url)
    except ConnectionError:
        print &apos;Error Occured &apos;, url
    finally:
        print &apos;URL &apos;, url, &apos; Scraped&apos;


if __name__ == &apos;__main__&apos;:
    pool = Pool(processes=3)
    urls = [
        &apos;https://www.baidu.com&apos;,
        &apos;http://www.meituan.com/&apos;,
        &apos;http://blog.csdn.net/&apos;,
        &apos;http://xxxyxxx.net&apos;
    ]
    pool.map(scrape, urls)
</code></pre><p>&#x5728;&#x8FD9;&#x91CC;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;Pool&#xFF0C;&#x6307;&#x5B9A;&#x8FDB;&#x7A0B;&#x6570;&#x4E3A;3&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x81EA;&#x52A8;&#x6839;&#x636E;CPU&#x5185;&#x6838;&#x6765;&#x5206;&#x914D;&#x8FDB;&#x7A0B;&#x6570;&#x3002;</p>
<p>&#x7136;&#x540E;&#x6709;&#x4E00;&#x4E2A;&#x94FE;&#x63A5;&#x5217;&#x8868;&#xFF0C;map&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x904D;&#x5386;&#x6BCF;&#x4E2A;URL&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x5176;&#x5206;&#x522B;&#x6267;&#x884C;scrape&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre><code>&lt;Response [403]&gt;
URL  http://blog.csdn.net/  Scraped
&lt;Response [200]&gt;
URL  https://www.baidu.com  Scraped
Error Occured  http://xxxyxxx.net
URL  http://xxxyxxx.net  Scraped
&lt;Response [200]&gt;
URL  http://www.meituan.com/  Scraped
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x904D;&#x5386;&#x5C31;&#x8FD9;&#x4E48;&#x8F7B;&#x677E;&#x5730;&#x5B9E;&#x73B0;&#x4E86;&#x3002;</p>
<h2 id="&#x7ED3;&#x8BED;">&#x7ED3;&#x8BED;</h2>
<p>&#x591A;&#x8FDB;&#x7A0B;multiprocessing&#x76F8;&#x6BD4;&#x591A;&#x7EBF;&#x7A0B;&#x529F;&#x80FD;&#x5F3A;&#x5927;&#x592A;&#x591A;&#xFF0C;&#x800C;&#x4E14;&#x4F7F;&#x7528;&#x8303;&#x56F4;&#x66F4;&#x5E7F;&#xFF0C;&#x5E0C;&#x671B;&#x672C;&#x6587;&#x5BF9;&#x5927;&#x5BB6;&#x6709;&#x5E2E;&#x52A9;&#xFF01;</p>
<h2 id="&#x672C;&#x6587;&#x53C2;&#x8003;">&#x672C;&#x6587;&#x53C2;&#x8003;</h2>
<p><a href="https://docs.python.org/2/library/multiprocessing.html" target="_blank">https://docs.python.org/2/library/multiprocessing.html</a></p>
<p><a href="http://www.cnblogs.com/vamei/archive/2012/10/12/2721484.html" target="_blank">http://www.cnblogs.com/vamei/archive/2012/10/12/2721484.html</a></p>
<p><a href="http://www.cnblogs.com/kaituorensheng/p/4445418.html" target="_blank">http://www.cnblogs.com/kaituorensheng/p/4445418.html</a></p>
<p><a href="https://my.oschina.net/yangyanxing/blog/296052" target="_blank">https://my.oschina.net/yangyanxing/blog/296052</a></p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../chapter4/section5.html" class="navigation navigation-prev " aria-label="Previous page: 5. Python爬虫进阶五之多线程的用法"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../chapter4/section7.html" class="navigation navigation-next " aria-label="Next page: 7. Python爬虫进阶七之设置ADSL拨号服务器代理"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
