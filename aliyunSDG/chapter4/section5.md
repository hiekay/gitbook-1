从2016年12月份到2017年，互联网用户陆续遭受到不同类型数据的勒索事件，笔者统计了一下，大概至少有5中类型的针对数据的勒索事件：

- ElasticSearch勒索事件
- MongoDB勒索事件
- MySQL勒索事件
- Redis勒索事件
- PostgreSQL勒索事件
- 甚至还有针对Oracle的勒索事件……

看起来只要是“裸奔”在互联网上的数据库，都未能幸免，成百上千个开放在公网的 MySQL 数据库被劫持，攻击者删除了数据库中的存储数据，并留下勒索信息，要求支付比特币以赎回数据。这对于企业用户，如果发生这样的事情，可能面临一场“灾难”。

以下攻击者针对MongoDB勒索留下的勒索信息:

![mongodb](http://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/assets/pic/60893/cn_zh/1508896175099/%E5%8B%92%E7%B4%A2.jpg)

#一.事件原因

从MongoDB 和 Elasticsearch 以及现在的 MySQL 数据库勒索的案例里面发现，可以发现都是基线安全问题导致被黑客劫持数据而勒索，

主要问题的根因是由于这些被勒索的自建数据库服务都开放在公网上，并且存在空密码或者弱口令等使得攻击者可以轻易暴力破解成功，直接连上数据库从而下载并清空数据，特别是不正确的安全组配置或没有配置任何网络访问控制策略导致问题被放大。

基线安全问题已经成了Web漏洞之外入侵服务器的主要途径，特别是无网络访问控制、默认账号和空口令、默认账号弱口令、后台暴露、后台无口令未授权访问等情况。错误的配置可以导致相关服务暴露在公网上，成为黑客攻击的目标，加上采用空密码等弱口令，黑客以极低的攻击成本轻松获取和入侵这些服务。

#二.安全隐患自查

找到了原因，我就可以”对症下药”了，您可以通过自动化检测攻击或人工两种方式进行排查:

##1.自动化检测方式：

阿里云安骑士提供默认的检测策略，无需安装，您可以登录到控制台，查看安骑士检测的结果，并根据结果进行整改封堵漏洞。aegis

![](http://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/assets/pic/60893/cn_zh/1508896421466/qiy.jpg)

![](http://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/assets/pic/60893/cn_zh/1508896443507/mysql.jpg)

##2.人工+工具排查:

您也可以使用类似NMap这样的端口扫描工具直接针对被检查的服务器IP(在服务器外网执行)执行扫描，以确认业务服务器开放在外网的端口和服务。

注:需要在授权情况下对自身业务进行扫描，不要对其他不相关的业务进行非法扫描，避免法律风险。

#三.安全建议及修复方案

##1.配置严格网络访问控制策略

当您安装完服务或在运维过程中发现对外开放了服务后，您可以使用Windows 自带防火墙功能、Linux系统的iptables防火墙功能配置必要的访问控制策略，当然，最简单的方式可以使用ECS的安全组 策略控制内外网出入的流量，防止暴露更多不安全的服务。

##2.对操作系统和服务进行安全加固

必要的安全加固是确保业务在云上安全可靠运行的条件，您可以使用安骑士的自动化检测和人工加固指南对业务服务器进行安全加固。

![db](http://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/assets/pic/60893/cn_zh/1508896757703/db.jpg)

请点击参考更多的[安全加固指南](https://help.aliyun.com/knowledge_list/60793.html?spm=5176.7760893.2.3.3CWRla)。